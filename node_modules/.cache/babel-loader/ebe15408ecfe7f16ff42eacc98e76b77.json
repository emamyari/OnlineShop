{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n    return _extendStatics(d, b);\n  };\n  return function (d, b) {\n    _extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nimport { getCanonicalLocales } from './get-canonical-locales';\nimport { invariant } from './invariant';\nimport { toObject, getOption } from './polyfill-utils';\nexport function createResolveLocale(getDefaultLocale) {\n  var lookupMatcher = createLookupMatcher(getDefaultLocale);\n  var bestFitMatcher = createBestFitMatcher(getDefaultLocale);\n  /**\r\n   * https://tc39.es/ecma402/#sec-resolvelocale\r\n   */\n  return function resolveLocale(availableLocales, requestedLocales, options, relevantExtensionKeys, localeData) {\n    var matcher = options.localeMatcher;\n    var r;\n    if (matcher === 'lookup') {\n      r = lookupMatcher(availableLocales, requestedLocales);\n    } else {\n      r = bestFitMatcher(availableLocales, requestedLocales);\n    }\n    var foundLocale = r.locale;\n    var result = {\n      locale: '',\n      dataLocale: foundLocale\n    };\n    var supportedExtension = '-u';\n    for (var _i = 0, relevantExtensionKeys_1 = relevantExtensionKeys; _i < relevantExtensionKeys_1.length; _i++) {\n      var key = relevantExtensionKeys_1[_i];\n      var foundLocaleData = localeData[foundLocale];\n      invariant(typeof foundLocaleData === 'object' && foundLocaleData !== null, \"locale data \" + key + \" must be an object\");\n      var keyLocaleData = foundLocaleData[key];\n      invariant(Array.isArray(keyLocaleData), \"keyLocaleData for \" + key + \" must be an array\");\n      var value = keyLocaleData[0];\n      invariant(typeof value === 'string' || value === null, 'value must be string or null');\n      var supportedExtensionAddition = '';\n      if (r.extension) {\n        var requestedValue = unicodeExtensionValue(r.extension, key);\n        if (requestedValue !== undefined) {\n          if (requestedValue !== '') {\n            if (~keyLocaleData.indexOf(requestedValue)) {\n              value = requestedValue;\n              supportedExtensionAddition = \"-\" + key + \"-\" + value;\n            }\n          } else if (~requestedValue.indexOf('true')) {\n            value = 'true';\n            supportedExtensionAddition = \"-\" + key;\n          }\n        }\n      }\n      if (key in options) {\n        var optionsValue = options[key];\n        invariant(typeof optionsValue === 'string' || typeof optionsValue === 'undefined' || optionsValue === null, 'optionsValue must be String, Undefined or Null');\n        if (~keyLocaleData.indexOf(optionsValue)) {\n          if (optionsValue !== value) {\n            value = optionsValue;\n            supportedExtensionAddition = '';\n          }\n        }\n      }\n      result[key] = value;\n      supportedExtension += supportedExtensionAddition;\n    }\n    if (supportedExtension.length > 2) {\n      var privateIndex = foundLocale.indexOf('-x-');\n      if (privateIndex === -1) {\n        foundLocale = foundLocale + supportedExtension;\n      } else {\n        var preExtension = foundLocale.slice(0, privateIndex);\n        var postExtension = foundLocale.slice(privateIndex, foundLocale.length);\n        foundLocale = preExtension + supportedExtension + postExtension;\n      }\n      foundLocale = getCanonicalLocales(foundLocale)[0];\n    }\n    result.locale = foundLocale;\n    return result;\n  };\n}\n/**\r\n * https://tc39.es/ecma402/#sec-unicodeextensionvalue\r\n * @param extension\r\n * @param key\r\n */\nfunction unicodeExtensionValue(extension, key) {\n  invariant(key.length === 2, 'key must have 2 elements');\n  var size = extension.length;\n  var searchValue = \"-\" + key + \"-\";\n  var pos = extension.indexOf(searchValue);\n  if (pos !== -1) {\n    var start = pos + 4;\n    var end = start;\n    var k = start;\n    var done = false;\n    while (!done) {\n      var e = extension.indexOf('-', k);\n      var len = void 0;\n      if (e === -1) {\n        len = size - k;\n      } else {\n        len = e - k;\n      }\n      if (len === 2) {\n        done = true;\n      } else if (e === -1) {\n        end = size;\n        done = true;\n      } else {\n        end = e;\n        k = e + 1;\n      }\n    }\n    return extension.slice(start, end);\n  }\n  searchValue = \"-\" + key;\n  pos = extension.indexOf(searchValue);\n  if (pos !== -1 && pos + 3 === size) {\n    return '';\n  }\n  return undefined;\n}\nvar UNICODE_EXTENSION_SEQUENCE_REGEX = /-u(?:-[0-9a-z]{2,8})+/gi;\n/**\r\n * https://tc39.es/ecma402/#sec-bestavailablelocale\r\n * @param availableLocales\r\n * @param locale\r\n */\nfunction bestAvailableLocale(availableLocales, locale) {\n  var candidate = locale;\n  while (true) {\n    if (~availableLocales.indexOf(candidate)) {\n      return candidate;\n    }\n    var pos = candidate.lastIndexOf('-');\n    if (!~pos) {\n      return undefined;\n    }\n    if (pos >= 2 && candidate[pos - 2] === '-') {\n      pos -= 2;\n    }\n    candidate = candidate.slice(0, pos);\n  }\n}\nfunction createLookupMatcher(getDefaultLocale) {\n  /**\r\n   * https://tc39.es/ecma402/#sec-lookupmatcher\r\n   */\n  return function lookupMatcher(availableLocales, requestedLocales) {\n    var result = {\n      locale: ''\n    };\n    for (var _i = 0, requestedLocales_1 = requestedLocales; _i < requestedLocales_1.length; _i++) {\n      var locale = requestedLocales_1[_i];\n      var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n      var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n      if (availableLocale) {\n        result.locale = availableLocale;\n        if (locale !== noExtensionLocale) {\n          result.extension = locale.slice(noExtensionLocale.length + 1, locale.length);\n        }\n        return result;\n      }\n    }\n    result.locale = getDefaultLocale();\n    return result;\n  };\n}\nfunction createBestFitMatcher(getDefaultLocale) {\n  return function bestFitMatcher(availableLocales, requestedLocales) {\n    var result = {\n      locale: ''\n    };\n    for (var _i = 0, requestedLocales_2 = requestedLocales; _i < requestedLocales_2.length; _i++) {\n      var locale = requestedLocales_2[_i];\n      var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n      var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n      if (availableLocale) {\n        result.locale = availableLocale;\n        if (locale !== noExtensionLocale) {\n          result.extension = locale.slice(noExtensionLocale.length + 1, locale.length);\n        }\n        return result;\n      }\n    }\n    result.locale = getDefaultLocale();\n    return result;\n  };\n}\nexport function getLocaleHierarchy(locale, aliases, parentLocales) {\n  var results = [locale];\n  if (aliases[locale]) {\n    locale = aliases[locale];\n    results.push(locale);\n  }\n  var parentLocale = parentLocales[locale];\n  if (parentLocale) {\n    results.push(parentLocale);\n  }\n  var localeParts = locale.split('-');\n  for (var i = localeParts.length; i > 1; i--) {\n    results.push(localeParts.slice(0, i - 1).join('-'));\n  }\n  return results;\n}\nfunction lookupSupportedLocales(availableLocales, requestedLocales) {\n  var subset = [];\n  for (var _i = 0, requestedLocales_3 = requestedLocales; _i < requestedLocales_3.length; _i++) {\n    var locale = requestedLocales_3[_i];\n    var noExtensionLocale = locale.replace(UNICODE_EXTENSION_SEQUENCE_REGEX, '');\n    var availableLocale = bestAvailableLocale(availableLocales, noExtensionLocale);\n    if (availableLocale) {\n      subset.push(availableLocale);\n    }\n  }\n  return subset;\n}\nexport function supportedLocales(availableLocales, requestedLocales, options) {\n  var matcher = 'best fit';\n  if (options !== undefined) {\n    options = toObject(options);\n    matcher = getOption(options, 'localeMatcher', 'string', ['lookup', 'best fit'], 'best fit');\n  }\n  if (matcher === 'best fit') {\n    return lookupSupportedLocales(availableLocales, requestedLocales);\n  }\n  return lookupSupportedLocales(availableLocales, requestedLocales);\n}\nvar MissingLocaleDataError = /** @class */function (_super) {\n  __extends(MissingLocaleDataError, _super);\n  function MissingLocaleDataError() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.type = 'MISSING_LOCALE_DATA';\n    return _this;\n  }\n  return MissingLocaleDataError;\n}(Error);\nexport function isMissingLocaleDataError(e) {\n  return e.type === 'MISSING_LOCALE_DATA';\n}\nexport function unpackData(locale, localeData, /** By default shallow merge the dictionaries. */\nreducer) {\n  if (reducer === void 0) {\n    reducer = function reducer(all, d) {\n      return __assign(__assign({}, all), d);\n    };\n  }\n  var localeHierarchy = getLocaleHierarchy(locale, localeData.aliases, localeData.parentLocales);\n  var dataToMerge = localeHierarchy.map(function (l) {\n    return localeData.data[l];\n  }).filter(Boolean);\n  if (!dataToMerge.length) {\n    throw new MissingLocaleDataError(\"Missing locale data for \\\"\" + locale + \"\\\", lookup hierarchy: \" + localeHierarchy.join(', '));\n  }\n  dataToMerge.reverse();\n  return dataToMerge.reduce(reducer, {});\n}","map":null,"metadata":{},"sourceType":"module"}